
<!doctype html>
<head>
<title>离婚大作战</title>
<meta charset="utf-8" />
<meta id="ShareUrl1" property="og:url" content="shareurl" />
<meta property="og:type" content="website" />
<meta property="og:title" content="謹賀新年" />
<meta property="og:description" content="友達から年賀状が届きました！開けてみましょう！" />
<meta property="og:image" content="img/icon.png" />
<style>
    body,html{width:100%;height:100%;}
    .share{display:none;}
</style>
</head>
<body>
    <div class="choujiang" id="choujiang">
        <img src="img/wrap.png" alt="" class="start_img">
    </div>
    <div class="share" id="share">
        <img name="randimg" src="img/m01.jpg" class="randimg">
        <button id="replay">再玩一次</button>
    </div>
    <script>

        var rand1 = 0;
        var useRand = 0;
        var images=[];

        function preloadimages(arr){
            var arr=(typeof arr!="object")? [arr] : arr; 
            for (var i = 0; i < arr.length; i++){
                images[i] = new Image();
                images[i].src = arr[i];
            }
        }

        preloadimages(['img/m01.jpg','img/m02.jpg','img/m03.jpg','img/m04.jpg']);

        function showMM() {
            var imgnum = images.length - 1;
            do {
                var randnum = Math.random();
                rand1 = Math.round(imgnum* randnum);
            } while (rand1 == useRand);
            useRand = rand1;
            document.randimg.src = images[useRand].src;

            choujiang.style.display="none";
            share.style.display="block";
        }
          
        var choujiang = document.getElementById("choujiang"),
            share = document.getElementById("share"),
            replay = document.getElementById("replay"),
            timeoutID;
            console.log(choujiang.children[0].src);

        choujiang.onclick = function(){
            choujiang.children[0].src="img/giffer3.gif";
            setTimeout('showMM()',1000);
        }

        replay.onclick = function(){
            clearTimeout(timeoutID);
            choujiang.style.display = "block";
            choujiang.children[0].src="img/wrap.png";
            share.style.display = "none";
        }



    //     var Gifffer = function() {
    //     var images, d = document, ga = 'getAttribute', sa = 'setAttribute';
    //     images = d && d.querySelectorAll ? d.querySelectorAll('[data-gifffer]') : [];
    //     var createContainer = function(w, h, el) {
    //         var con = d.createElement('DIV'), cls = el[ga]('class'), id = el[ga]('id');
    //         cls ? con[sa]('class', el[ga]('class')) : null;
    //         id ? con[sa]('id', el[ga]('id')) : null;
    //         con[sa]('style', 'position:relative;cursor:pointer;width:' + w + 'px;height:' + h + 'px;');
    //         // creating play button
    //         var play = d.createElement('DIV');
    //         play[sa]('style', 'width:60px;height:60px;border-radius:30px;background:rgba(0, 0, 0, 0.3);position:absolute;left:' + ((w/2)-30) + 'px;top:' + ((h/2)-30) + 'px;');
    //         var trngl = d.createElement('DIV');
    //         trngl[sa]('style', 'width:0;height: 0;border-top:14px solid transparent;border-bottom:14px solid transparent;border-left:14px solid rgba(0, 0, 0, 0.5);position:absolute;left:26px;top:16px;')
    //         play.appendChild(trngl);
    //         // dom placement
    //         con.appendChild(play);
    //         el.parentNode.replaceChild(con, el);
    //         return {c: con, p: play };
    //     }
    //     var process = function(el) {
    //         var url, con, c, w, h, play, gif, playing = false, cc, isC;
    //         url = el[ga]('data-gifffer');
    //         w = el[ga]('data-gifffer-width');
    //         h = el[ga]('data-gifffer-height');
    //         el.style.display = 'block';
    //         c = document.createElement('canvas');
    //         isC = !!(c.getContext && c.getContext('2d'));
    //         if(w && h && isC) cc = createContainer(w, h, el);
    //         el.onload = function() {
    //             if(isC) {
    //                 w = w || el.width;
    //                 h = h || el.height;
    //                 // creating the container
    //                 if(!cc) cc = createContainer(w, h, el);
    //                 con = cc.c;
    //                 play = cc.p;
    //                 con.addEventListener('click', function() {
    //                     if(!playing) {
    //                         playing = true;
    //                         gif = d.createElement('IMG');
    //                         gif[sa]('style', 'width:' + w + 'px;height:' + h + 'px;');
    //                         gif[sa]('data-uri', Math.floor(Math.random()*100000) + 1);
    //                         setTimeout(function() {
    //                             gif.src = url;
    //                         }, 0);                        
    //                         con.removeChild(play);
    //                         con.removeChild(c);
    //                         con.appendChild(gif);
    //                     } else {
    //                         playing = false;
    //                         con.appendChild(play);
    //                         con.removeChild(gif);
    //                         con.appendChild(c);
    //                         gif = null;
    //                     }
    //                 });
    //                 // canvas
    //                 c.width = w;
    //                 c.height = h;
    //                 c.getContext('2d').drawImage(el, 0, 0, w, h);
    //                 con.appendChild(c);
    //             }
    //         }
    //         el.src = url;
    //     }
    //     for(var i=0; i<images.length; i++) process(images[i]);
    // }

</script>
</body>
</html>